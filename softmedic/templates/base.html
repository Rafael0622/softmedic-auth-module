{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Soft-Medic{% endblock %}</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Estilos personalizados -->
    <style>
        body {
            background-color: #f8f9fa;
        }
        header {
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }
        footer {
            background: #f1f1f1;
            padding: 10px 0;
            text-align: center;
            margin-top: 40px;
            font-size: 0.9rem;
            color: #555;
        }
        .logo {
            height: 50px;
        }
    </style>

    {% block extra_head %}{% endblock %}
</head>

<body>

<!-- ============================================================= -->
<!-- Proyecto: SOFT-MEDIC                                        -->
<!-- Archivo: templates/base.html                                -->
<!-- VersiÃ³n: 1.3                                                -->
<!-- Fecha: 23/11/2025                                           -->
<!-- Elaborado por: Prixma Software Projects                     -->
<!-- Revisado por: DirecciÃ³n TÃ©cnica de SOFT-MEDIC               -->
<!-- DescripciÃ³n: Agregado menÃº de Reportes                      -->
<!-- ============================================================= -->

<header class="bg-primary text-white py-3 mb-4">
    <div class="container d-flex justify-content-between align-items-center">

        <!-- LOGO + NOMBRE -->
        <div class="d-flex align-items-center">
            <img src="{% static 'img/logo_softmedic.png' %}" alt="Logo Soft-Medic" class="logo me-3">
            <h2 class="m-0">Soft-Medic</h2>
        </div>

        <!-- USUARIO / ACCIONES -->
        <nav>
            {% if user.is_authenticated %}
                <span class="me-3">ðŸ‘¤ {{ user.nombre }}</span>
                <a href="{% url 'users:logout' %}" class="btn btn-light btn-sm">Cerrar sesiÃ³n</a>
            {% else %}
                <a href="{% url 'users:login' %}" class="text-white me-3 text-decoration-none">Iniciar sesiÃ³n</a>
                <a href="{% url 'users:register' %}" class="text-white text-decoration-none">Registrarse</a>
            {% endif %}
        </nav>

    </div>
</header>

{% if user.is_authenticated %}
<nav class="bg-light border-bottom py-2">
    <div class="container d-flex gap-3 align-items-center">

        <!-- ADMIN y RECEPCIONISTA: solo ver/listar historias -->
        {% if user.rol == "ADMIN" or user.rol == "RECEPCIONISTA" %}
            <a href="{% url 'historias:listar_historias' %}" class="btn btn-outline-primary btn-sm">
                ðŸ“„ Historias ClÃ­nicas
            </a>
        {% endif %}

        <!-- MEDICO -->
        {% if user.rol == "MEDICO" %}
            <a href="{% url 'historias:listar_historias' %}" class="btn btn-outline-primary btn-sm">
                ðŸ“„ Mis Historias ClÃ­nicas
            </a>

            <a href="{% url 'historias:crear_historia' %}" class="btn btn-primary btn-sm">
                âž• Nueva Historia ClÃ­nica
            </a>
        {% endif %}

        <!-- ============================================ -->
        <!--   M E N Ãš    D E    R E P O R T E S          -->
        <!-- ============================================ -->
        {% if user.rol == "ADMIN" or user.rol == "MEDICO" %}
        <div class="dropdown">
            <button class="btn btn-outline-success btn-sm dropdown-toggle" data-bs-toggle="dropdown">
                ðŸ“Š Reportes
            </button>

            <ul class="dropdown-menu">
                <li>
                    <a class="dropdown-item" href="{% url 'historias:reporte_pacientes_atendidos' %}">
                        ðŸ“„ Pacientes atendidos (CSV)
                    </a>
                </li>
            </ul>
        </div>
        {% endif %}

    </div>
</nav>
{% endif %}

{% if messages %}
<div class="container">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show mt-3" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    {% endfor %}
</div>
{% endif %}

<main class="container my-4">
    {% block content %}{% endblock %}
</main>

{% block extra_scripts %}{% endblock %}

<footer>
    Â© 2025 Soft-Medic | Sistema de gestiÃ³n mÃ©dica
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>

<!-- ============================================================= -->
<!-- CONTROL DE CAMBIOS                                          -->
<!-- VersiÃ³n | Fecha       | Autor / Responsable                | DescripciÃ³n
     1.2     | 23/11/2025  | Prixma Software Projects           | Retiro botÃ³n crear HCE admin/recep
     1.3     | 23/11/2025  | Prixma Software Projects           | Agregado menÃº Reportes
<!-- ============================================================= -->
